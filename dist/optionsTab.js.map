{"version":3,"sources":["../src/optionsTab.js"],"names":["OptionsTabCtrl","$scope","$injector","$rootScope","templateSrv","panelCtrl","ctrl","panel","elem","renderChartOptions","jdata","find","length","children","editor","ace","edit","session","getSession","setMode","setTabSize","setUseWrapMode","tout","onChange","eoptions","getValue","render","on","window","clearTimeout","setTimeout","setTheme","setValue","restrict","scope","templateUrl","controller"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACqBA,oB;AACnB,gCAAYC,MAAZ,EAAoBC,SAApB,EAA+BC,UAA/B,EAA2CC,WAA3C,EAAwD;AAAA;;AACtD,eAAKC,SAAL,GAAiBJ,OAAOK,IAAxB;AACAL,iBAAOK,IAAP,GAAc,IAAd;AACA,eAAKC,KAAL,GAAa,KAAKF,SAAL,CAAeE,KAA5B;AACA,eAAKC,IAAL,GAAY,KAAKH,SAAL,CAAeG,IAA3B;AACA,eAAKC,kBAAL;AACD;;;;+CAEoB;AAAA;;AACnB,gBAAIC,QAAQ,KAAKF,IAAL,CAAUG,IAAV,CAAe,kBAAf,CAAZ;AACA,gBAAID,MAAME,MAAN,KAAiB,CAAjB,IAAsBF,MAAMG,QAAN,GAAiBD,MAAjB,KAA4B,CAAtD,EAAyD;AACvD;AACD;AACD,gBAAIE,SAASC,IAAIC,IAAJ,CAASN,MAAM,CAAN,CAAT,CAAb;AACA,gBAAIO,UAAUH,OAAOI,UAAP,EAAd;AACAD,oBAAQE,OAAR,CAAgB,eAAhB;AACAF,oBAAQG,UAAR,CAAmB,CAAnB;AACAH,oBAAQI,cAAR,CAAuB,IAAvB;AACA,gBAAIC,OAAO,IAAX;AACA,gBAAIC,WAAW,SAAXA,QAAW,GAAM;AACnBD,qBAAO,IAAP;AACA,oBAAKf,KAAL,CAAWiB,QAAX,GAAsBP,QAAQQ,QAAR,EAAtB;AACA,oBAAKpB,SAAL,CAAeqB,MAAf;AACD,aAJD;AAKAT,oBAAQU,EAAR,CAAW,QAAX,EAAqB,YAAK;AACxBL,sBAAQM,OAAOC,YAAP,CAAoBP,IAApB,CAAR;AACAA,qBAAOM,OAAOE,UAAP,CAAkBP,QAAlB,EAA4B,IAA5B,CAAP;AACD,aAHD;AAIAT,mBAAOiB,QAAP,CAAgB,oBAAhB;AACAjB,mBAAOkB,QAAP,CAAgB,KAAKzB,KAAL,CAAWiB,QAA3B;AACD;;;2CAEuB;AACtB,mBAAO;AAAA,qBAAO;AACZS,0BAAU,GADE;AAEZC,uBAAO,IAFK;AAGZC,6BAAa,qDAHD;AAIZC,4BAAYpC;AAJA,eAAP;AAAA,aAAP;AAMD;;;;;;yBAxCkBA,c","file":"optionsTab.js","sourcesContent":["\r\nexport default class OptionsTabCtrl {\r\n  constructor($scope, $injector, $rootScope, templateSrv) {\r\n    this.panelCtrl = $scope.ctrl;\r\n    $scope.ctrl = this;\r\n    this.panel = this.panelCtrl.panel;\r\n    this.elem = this.panelCtrl.elem;\r\n    this.renderChartOptions();\r\n  }\r\n\r\n  renderChartOptions() {\r\n    var jdata = this.elem.find('.json-ace-editor');\r\n    if (jdata.length === 0 || jdata.children().length !== 0) {\r\n      return;\r\n    }\r\n    var editor = ace.edit(jdata[0]);\r\n    var session = editor.getSession();\r\n    session.setMode(\"ace/mode/json\");\r\n    session.setTabSize(2);\r\n    session.setUseWrapMode(true);\r\n    var tout = null;\r\n    var onChange = () => {\r\n      tout = null;\r\n      this.panel.eoptions = session.getValue();\r\n      this.panelCtrl.render();\r\n    };\r\n    session.on('change', () =>{\r\n      tout && window.clearTimeout(tout);\r\n      tout = window.setTimeout(onChange, 2000);\r\n    });\r\n    editor.setTheme(\"ace/theme/ambience\");\r\n    editor.setValue(this.panel.eoptions);\r\n  }\r\n\r\n  static buildDirective() {\r\n    return () => ({\r\n      restrict: 'E',\r\n      scope: true,\r\n      templateUrl: 'public/plugins/grafana-echart-panel/optionsTab.html',\r\n      controller: OptionsTabCtrl,\r\n    });\r\n  }\r\n}\r\n"]}